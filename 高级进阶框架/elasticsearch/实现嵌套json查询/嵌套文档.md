```
嵌套文档总结：
1 最大的问题是随着嵌套文档的增加，总文档数量是成倍增加的。性能一般
2 GET _cat/indices?v 这个查询是查询索引库里面每个索引总的文档数，包括嵌套文档数量
3 GET order_index/_count 这个查询是查询当前索引的文档数，不包括嵌套文档数量
4 由于嵌套文档被索引为单独的文档，因此只能在nested查询
5 为具有100个嵌套字段的文档建立索引实际上是为101个文档建立索引，因为每个嵌套文档都被索引为一个单独的文档。为了防止定义不正确的映射，每个索引可以定义的嵌套字段的数量默认为限制为50

DELETE order_index

# 新增索引库
PUT order_index
{
  "mappings": {
    "properties": {
      "orderId": {
        "type": "keyword"
      },
      "orderNo": {
        "type": "keyword"
      },
      "orderUserName": {
        "type": "keyword"
      },
      "orderItem": {
        "type": "nested", 
        "properties": {
          "orderItemId": {
            "type": "keyword"
          },
          "orderId": {
            "type": "keyword"
          },
          "productName": {
            "type": "keyword"
          },
          "brandName": {
            "type": "keyword"
          },
          "sellPrice": {
            "type": "keyword"
          }
        }
      }
    }
  }
}

# 新增id为1的文档
PUT order_index/_doc/1
{
  "orderId": "1",
  "orderNo": "123456",
  "orderUserName": "张三",
  "orderItem": [
    {
      "orderItemId": "12234",
      "orderId": "1",
      "productName": "火腿肠",
      "brandName": "双汇",
      "sellPrice": "28"
    },
    {
      "orderItemId": "12235",
      "orderId": "1",
      "productName": "果冻",
      "brandName": "汇源",
      "sellPrice": "12"
    }
  ]
}

GET order_index/_search

GET order_index/_search
{
  "query": {
    "nested": {
      "path": "orderItem",
      "query": {
        "bool": {
          "must": [
            {
              "match": {
                "orderItem.productName": "火腿肠"
              }
            },
            {
              "match": {
                "orderItem.brandName": "汇源"
              }
            }
          ]
        }
      }
    }
  }
}


GET order_index/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "orderItem.productName": "火腿肠"
          }
        },
        {
          "match": {
            "orderItem.brandName": "汇源"
          }
        }
      ]
    }
  }
}
```